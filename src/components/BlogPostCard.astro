---
import { Icon } from "astro-icon/components";
import type { CollectionEntry } from "astro:content";

interface Props {
  post: CollectionEntry<"blog">;
  delay?: string;
}

const { post, delay } = Astro.props;
const isExternal = !!post.data.externalUrl;
---

<article>
  <a
    href={isExternal ? post.data.externalUrl : `/blog/${post.id}`}
    target={isExternal ? "_blank" : undefined}
    rel={isExternal ? "noopener noreferrer" : undefined}
    class="glass-card group block p-6 animate-on-scroll"
    data-delay={delay}
  >
    <div class="flex items-center gap-2">
      <h3 class="font-medium text-[var(--color-text)] group-hover:text-[var(--color-accent)] transition-colors">
        {post.data.title}
      </h3>
      {post.data.draft && (
        <span class="flex-shrink-0 rounded-full bg-amber-500/15 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wider text-amber-600 dark:text-amber-400">
          Draft
        </span>
      )}
      {isExternal && (
        <Icon
          name="lucide:external-link"
          size={16}
          class="flex-shrink-0 text-[var(--color-text-secondary)] group-hover:text-[var(--color-accent)] transition-colors"
        />
      )}
    </div>
    {post.data.description && (
      <p class="mt-2 text-sm text-[var(--color-text-secondary)] leading-relaxed line-clamp-2">
        {post.data.description}
      </p>
    )}
    <div class="mt-3 flex items-center justify-between gap-2">
      <div class="flex flex-wrap items-center gap-2">
        {post.data.tags.slice(0, 3).map((tag) => (
          <span class="badge">{tag}</span>
        ))}
      </div>
      <time
        datetime={post.data.date.toISOString()}
        class="flex-shrink-0 text-xs text-[var(--color-text-secondary)]"
      >
        {post.data.date.toLocaleDateString("en-US", {
          year: "numeric",
          month: "short",
          day: "numeric",
        })}
      </time>
    </div>
  </a>
</article>
