---
import { Icon } from "astro-icon/components";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { personal } from "@/data/personal";
import { getCollection } from "astro:content";
//import { featuredSkills } from "@/data/skills";
import SocialLinksGrid from "@/components/SocialLinksGrid.astro";
import BlogPostCard from "@/components/BlogPostCard.astro";

const allPosts = await getCollection("blog", ({ data }) => !data.draft);
const recentPosts = allPosts
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 2);
---

<BaseLayout title={`${personal.name} - ${personal.tagline}`}>
  <!-- Hero -->
  <section class="mx-auto max-w-5xl px-6 pt-20 pb-12 sm:pt-28 sm:pb-16">
    <div class="max-w-2xl">
      <div class="animate-on-scroll">
        <p class="section-label mb-4">Hey there, welcome to my website!</p>
        <h1 class="text-4xl font-bold tracking-tight text-[var(--color-text)] sm:text-5xl">
          {personal.name}
        </h1>
        <p class="mt-3 text-xl text-[var(--color-accent)]">
          {personal.tagline}
        </p>
      </div>

      <div class="animate-on-scroll" data-delay="1">
        <p class="mt-6 text-[var(--color-text-secondary)] leading-relaxed">
          {personal.bio}
        </p>
      </div>

      <!-- CTAs -->
      <div class="mt-8 flex flex-wrap gap-4 animate-on-scroll" data-delay="2">
        <a href="/resume" class="btn-primary">
          <Icon name="lucide:briefcase" size={16} />
          View Resume
        </a>
        <a href="/projects" class="btn-outline">
          <Icon name="lucide:code" size={16} />
          See Projects
        </a>
        <a href="/blog" class="btn-outline">
          <Icon name="lucide:pen-line" size={16} />
          Read Blog
        </a>
      </div>
    </div>
  </section>

  <!-- Tech stack -->
  <!--<section class="mx-auto max-w-5xl px-6 pb-16">
    <h2 class="section-label mb-6 animate-on-scroll">Technologies I Work With</h2>
    <div class="grid grid-cols-3 gap-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8">
      {featuredSkills.map((skill, i) => {
        const Tag = skill.url ? "a" : "div";
        const linkProps = skill.url ? { href: skill.url, target: "_blank", rel: "noopener noreferrer" } : {};
        return (
          <Tag
            {...linkProps}
            class="glass-card flex flex-col items-center gap-2 p-4 animate-on-scroll"
            data-delay={String(Math.min(i % 4 + 1, 6))}
          >
            <Icon
              name={skill.icon.includes(":") ? skill.icon : `simple-icons:${skill.icon}`}
              size={28}
              style={`color: ${skill.color};${skill.darkColor ? ` --skill-dark: ${skill.darkColor};` : ""}`}
            />
            <span class="text-xs text-[var(--color-text-secondary)] text-center leading-tight h-max">
              {skill.name}
            </span>
          </Tag>
        );
      })}
    </div>
  </section>-->

  <!-- Recent writing -->
  {recentPosts.length > 0 && (
    <section class="mx-auto max-w-5xl px-6 pb-20">
      <h2 class="section-label mb-6 animate-on-scroll">Recent Writing</h2>
      <div class="grid gap-4 sm:grid-cols-2">
        {recentPosts.map((post, i) => (
          <BlogPostCard post={post} delay={String(i + 1)} />
        ))}
      </div>
    </section>
  )}

  <!-- Get in touch -->
  <section class="mx-auto max-w-5xl px-6 pb-20">
    <h2 class="section-label mb-6 animate-on-scroll">Get in Touch</h2>
    <SocialLinksGrid />
  </section>
</BaseLayout>
