---
import { Icon } from "astro-icon/components";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { personal } from "@/data/personal";
import { experiences } from "@/data/experience";
import { education } from "@/data/education";
import { skillCategories } from "@/data/skills";
import SkillBadge from "@/components/SkillBadge.astro";
import DateRange from "@/components/DateRange.astro";
import TimelineItem from "@/components/TimelineItem.astro";
---

<BaseLayout title={`Resume - ${personal.name}`} description={`Resume of ${personal.name} - Systems Engineer at Cloudflare`}>
  <div class="mx-auto max-w-5xl px-6 py-16 sm:py-20">
    <!-- Header -->
    <div class="mb-14 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between animate-on-scroll">
      <div>
        <h1 class="text-3xl font-bold tracking-tight">Resume</h1>
        <p class="mt-1 text-[var(--color-text-secondary)]">My professional experience and education</p>
      </div>
      <a
        href={personal.resume}
        target="_blank"
        rel="noopener noreferrer"
        class="btn-primary w-fit"
      >
        <Icon name="lucide:download" size={16} />
        Download PDF
      </a>
    </div>

    <!-- Experience -->
    <section class="mb-20">
      <h2 class="section-label mb-8 animate-on-scroll">Experience</h2>
      <ol reversed class="timeline list-none pl-0">
        {experiences.map((exp, i) => (
          <TimelineItem logo={exp.logo} logoAlt={exp.company} logoUrl={exp.companyUrl} delay={String(i + 1)}>
            <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
              <div>
                <h3 class="text-lg font-semibold text-[var(--color-text)]">{exp.title}</h3>
                <a
                  href={exp.companyUrl}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-link"
                >
                  {exp.company}
                </a>
              </div>
              <div class="flex flex-wrap gap-2 sm:flex-col sm:items-end">
                <span class="badge">
                  <Icon name="lucide:calendar" size={12} />
                  <DateRange startDate={exp.startDate} endDate={exp.endDate} />
                </span>
                <span class="badge">
                  <Icon name="lucide:map-pin" size={12} />
                  {exp.location}
                </span>
              </div>
            </div>
            <ul class="mt-5 space-y-2">
              {exp.descriptions.map((desc) => (
                <li class="flex items-start gap-3 text-sm text-[var(--color-text-secondary)]">
                  <span class="mt-1.5 h-1.5 w-1.5 rounded-full bg-[var(--color-accent)] flex-shrink-0" aria-hidden="true" />
                  {desc}
                </li>
              ))}
            </ul>
          </TimelineItem>
        ))}
      </ol>
    </section>

    <!-- Education -->
    <section class="mb-20">
      <h2 class="section-label mb-8 animate-on-scroll">Education</h2>
      <ol reversed class="timeline list-none pl-0">
        {education.map((edu, i) => (
          <TimelineItem logo={edu.logo} logoAlt={edu.institution} logoUrl={edu.institutionUrl} delay={String(i + 1)}>
            <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
              <div>
                <h3 class="text-lg font-semibold text-[var(--color-text)]">{edu.title}</h3>
                <a
                  href={edu.institutionUrl}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-link text-sm"
                >
                  {edu.institution}
                </a>
              </div>
              <div class="flex flex-wrap gap-2 sm:flex-col sm:items-end">
                <span class="badge">
                  <Icon name="lucide:calendar" size={12} />
                  <DateRange startDate={edu.startDate} endDate={edu.endDate} />
                </span>
                <span class="badge font-semibold">{edu.grade}</span>
              </div>
            </div>
            <ul class="mt-5 space-y-2">
              {edu.descriptions.map((desc) => (
                <li class="flex items-start gap-3 text-sm text-[var(--color-text-secondary)]">
                  <span class="mt-1.5 h-1.5 w-1.5 rounded-full bg-[var(--color-accent)] flex-shrink-0" aria-hidden="true" />
                  {desc}
                </li>
              ))}
            </ul>
          </TimelineItem>
        ))}
      </ol>
    </section>

    <!-- Skills -->
    <section>
      <h2 class="section-label mb-8 animate-on-scroll">Skills & Technologies</h2>
      <div class="space-y-6">
        {skillCategories.map((cat, i) => (
          <div class="glass-card p-6 animate-on-scroll" data-delay={String(i + 1)}>
            <h3 class="font-semibold text-[var(--color-text)] mb-4">{cat.title}</h3>
            <ul class="space-y-2 mb-5">
              {cat.descriptions.map((desc) => (
                <li class="flex items-start gap-3 text-sm text-[var(--color-text-secondary)]">
                  <span class="mt-1.5 h-1.5 w-1.5 rounded-full bg-[var(--color-accent)] flex-shrink-0" aria-hidden="true" />
                  {desc}
                </li>
              ))}
            </ul>
            <div class="flex flex-wrap gap-3">
              {cat.skills.filter((s) => !s.hidden).map((skill) => (
                <SkillBadge skill={skill} />
              ))}
            </div>
          </div>
        ))}
      </div>
    </section>
  </div>
</BaseLayout>
